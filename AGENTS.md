# AGENTS.md

This file provides instructions for AI coding agents working with this dotfiles repository.

## Project Overview

This is a personal dotfiles repository for **leocavalcante** (Leo Cavalcante) containing development environment configurations. The repository uses **GNU Stow** to manage symlinks and includes shell configurations, git settings, editor configs, and custom AI-powered developer tools.

## Project Structure

```
.
├── .alacritty.toml          # Alacritty terminal emulator config
├── .config/                 # Application configs
│   ├── kitty/              # Kitty terminal config
│   ├── nvim/               # Neovim editor config
│   └── starship.toml       # Starship prompt config
├── .emacs.d/               # Emacs editor config
├── .gemini/                # Gemini AI config
├── .gitconfig              # Git configuration
├── .tmux.conf              # Tmux terminal multiplexer config
├── .zshrc                  # Zsh shell configuration (main file)
└── README.md               # User-facing documentation
```

## Neovim Architecture

- `init.lua` - Entry point, bootstraps lazy.nvim, loads settings/keymaps/plugins
- `lua/settings.lua` - Editor settings and colorscheme loading
- `lua/keymaps.lua` - Key mappings (leader: Space)
- `lua/plugins/` - Individual plugin configurations as separate files
- `lua/colors/` - Custom colorscheme definitions

Key plugins: lsp-zero (with Mason for LSP management), telescope, harpoon, neo-tree, treesitter, copilot.

## Emacs Configuration

- `.emacs.d/init.el` - Uses straight.el package manager

## Theme

GitHub Dark Default theme is used consistently across all tools (Neovim, tmux, kitty, starship).

## Key Bindings

- **Neovim**: `jj` exits insert mode, `Ctrl+h/j/k/l` for window navigation
- **Tmux**: Prefix is `C-Space`. `prefix+j` horizontal split, `prefix+l` vertical split, `Ctrl+h/j/k/l` pane navigation, `prefix+s` session picker (sessionx)

## Setup and Installation

**Prerequisites:**
- GNU Stow must be installed
- Zsh shell
- Git

**Install dotfiles:**
```bash
cd ~/.dotfiles
stow .
```

This creates symlinks from the repository to `$HOME`.

## Key Tools and Functions

### Custom Shell Functions (defined in .zshrc)

1. **dot()** - Update dotfiles from repository
   - Pulls latest changes
   - Re-stows files
   
2. **commit()** - AI-generated git commit messages
   - Uses ChatGPT to generate commit messages from staged changes
   - Requires `chatgpt` CLI tool

3. **pr()** - AI-generated pull requests
   - Creates GitHub PR with AI-generated title and body
   - Uses `chatgpt` and `gh` CLI tools

4. **cld()** - Quick Claude AI access
   - Wrapper for Claude CLI with write/edit/bash tools enabled

5. **up()** - System update utility
   - Updates apt packages (Linux) and Homebrew

### Important Aliases

```bash
l, ls, ll   # eza (modern ls replacement)
cl          # clear
stk         # starship toggle kubernetes
python      # python3
pip         # pip3
push        # git push
```

## Environment Variables

- `EDITOR`, `GIT_EDITOR`, `KUBE_EDITOR`, `SUDO_EDITOR` → `nvim`
- `COMPOSE_BAKE=true`
- `LANG=en_US.UTF-8`
- PHP Composer paths configured
- Go paths configured (if Go installed)

## Agent Boundaries

**DO NOT:**
- Modify `.git/` directory
- Change file permissions or ownership
- Remove or modify existing working configurations without explicit user request
- Commit secrets or sensitive data
- Modify binary files in `.emacs.d/` or other config directories without understanding their purpose

**DO:**
- Keep modifications minimal and surgical
- Preserve existing formatting and structure
- Test commands before suggesting them
- Respect the user's existing tool choices (nvim, zsh, etc.)

## Dependencies

Required CLI tools:
- `gh` - GitHub CLI
- `stow` - GNU Stow
- `eza` - Modern ls replacement
- `zoxide` - Smart directory jumper
- `starship` - Cross-shell prompt
- `delta` - Git diff pager
- `nvim` - Neovim editor

Optional tools:
- `tmux` - Terminal multiplexer
- `claude` - Claude CLI
- `go` - Go programming language

## Coding Style

**Shell scripts:**
- Use bash or zsh syntax as appropriate
- Follow existing indentation (2 spaces)
- Use descriptive variable names
- Add comments only for complex logic
- Use `local` for function variables

**Configuration files:**
- Preserve existing format and style
- Keep comments intact
- Test changes before committing

## Git Workflow

1. Changes should be staged before using `commit()` function
2. Commit messages are generated by AI (chatgpt)
3. Use `push` alias or `--push` flag for pushing
4. Pull requests created via `pr()` or `--pr` flag

**Note:** Auto-setup remote is enabled (`push.autoSetupRemote = true`)

## Special Notes

- **Antigen plugin manager**: The repository uses Antigen for Zsh plugin management (auto-installed on first run). Do NOT recommend replacing it with alternatives like zinit, sheldon, etc. - this is a deliberate choice by the user. Antigen's startup overhead is acceptable for the simplicity and stability it provides.
- Symlinks are managed by GNU Stow - use `stow .` to apply changes
- Local git config can be added to `~/.gitconfig.local` (included automatically)

## Completed Optimizations (Jan 14, 2026)

The following .zshrc optimizations have already been implemented - DO NOT suggest these again:

- Removed Anthropic helper functions (`_set_anthropic_vars`, `_unset_anthropic_vars`) - now inline
- Consolidated duplicate Go version checks into single block
- Simplified `composer()` and `up()` functions with `emulate -L zsh`
- Added smart caching for starship initialization (binary mtime-based invalidation)
- Lazy-loaded zoxide (`z`, `zi` are stubs that init on first use)
- Replaced `command -v` checks with `(( $+commands[...] ))` hash lookups
- Lazy-loaded COMPOSER_AUTH (loads in `composer()` function, not at startup)
- Added history options: `HIST_FIND_NO_DUPS`, `INC_APPEND_HISTORY`, `APPEND_HISTORY`
- Added portable compinit with `(#qN.mh+24)` glob qualifier for cross-platform support
- Conditional Bun path addition with existence check
- Removed emoji decorations from status messages

**Result**: Reduced startup time by 30-80ms through reduced subprocesses and optimized initialization patterns.

## Testing Changes

After modifying configuration files:

1. For shell configs: `source ~/.zshrc` or restart terminal
2. For git config: Test with `git config --list`
3. For stow changes: `cd ~/.dotfiles && stow --restow .`

## Security

- **IMPORTANT**: This repository is publicly available at github.com/leocavalcante/dotfiles. Always verify that no sensitive data (API keys, tokens, passwords, credentials, or personal information) is being committed and pushed.
- Never commit API keys or tokens
- `~/.gitconfig.local` is for sensitive user-specific settings
- Composer auth is loaded from `~/.config/composer/auth.json`
- Be cautious with shell functions that execute AI-generated content

## Owner Information

- **Owner:** leocavalcante (Leo Cavalcante)
- **Purpose:** Personal development environment
- **Primary shell:** Zsh
- **Primary editor:** Neovim

## Additional Context

This is a personal, opinionated setup focused on:
- AI-assisted development workflows
- Terminal-based tools and editors
- Git workflow automation
- Cross-platform compatibility (Linux/macOS with Homebrew)
